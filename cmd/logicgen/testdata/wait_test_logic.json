{
  "version": "1.0",
  "package": "waitest",
  "handlers": [
    {
      "name": "OnAttackWithCooldown",
      "event": "AttackWithCooldown",
      "parameters": [
        {"name": "playerID", "type": "string"},
        {"name": "damage", "type": "int32"}
      ],
      "nodes": [
        {
          "id": "getDamage",
          "type": "Constant",
          "inputs": {
            "value": "param:damage"
          }
        },
        {
          "id": "waitCooldown",
          "type": "Wait",
          "inputs": {
            "duration": {"constant": 500},
            "unit": {"constant": "ms"}
          }
        },
        {
          "id": "applyDamage",
          "type": "SetField",
          "inputs": {
            "path": {"constant": "LastDamage"},
            "value": "param:damage"
          }
        }
      ],
      "flow": [
        { "from": "start", "to": "getDamage" },
        { "from": "getDamage", "to": "waitCooldown" },
        { "from": "waitCooldown", "to": "applyDamage" },
        { "from": "applyDamage", "to": "end" }
      ]
    },
    {
      "name": "OnWaitForCondition",
      "event": "WaitForCondition",
      "parameters": [],
      "nodes": [
        {
          "id": "getReady",
          "type": "GetField",
          "inputs": { "path": {"constant": "IsReady"} }
        },
        {
          "id": "waitUntilReady",
          "type": "WaitUntil",
          "inputs": {
            "condition": "node:getReady:value",
            "checkInterval": {"constant": 100},
            "timeout": {"constant": 5000}
          }
        },
        {
          "id": "checkTimedOut",
          "type": "If",
          "inputs": {
            "condition": "node:waitUntilReady:timedOut"
          }
        },
        {
          "id": "setFailed",
          "type": "SetField",
          "inputs": {
            "path": {"constant": "Status"},
            "value": {"constant": "timeout"}
          }
        },
        {
          "id": "setSuccess",
          "type": "SetField",
          "inputs": {
            "path": {"constant": "Status"},
            "value": {"constant": "ready"}
          }
        }
      ],
      "flow": [
        { "from": "start", "to": "getReady" },
        { "from": "getReady", "to": "waitUntilReady" },
        { "from": "waitUntilReady", "to": "checkTimedOut" },
        { "from": "checkTimedOut", "to": "setFailed", "label": "true" },
        { "from": "checkTimedOut", "to": "setSuccess", "label": "false" },
        { "from": "setFailed", "to": "end" },
        { "from": "setSuccess", "to": "end" }
      ]
    }
  ]
}
